// ã‚¹ã‚­ãƒ«ãƒã‚¹ã‚¿ãƒ¼API - æ–°ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å¯¾å¿œç‰ˆï¼ˆå›ºå®šãƒªã‚¹ãƒˆæä¾›ï¼‰
import { NextRequest, NextResponse } from 'next/server'

// æ–°ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£: ãƒã‚¹ã‚¿ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«å»ƒæ­¢ã€å›ºå®šãƒªã‚¹ãƒˆã§æä¾›
const FINANCE_SKILLS = [
  // IPOãƒ»ä¸Šå ´é–¢é€£
  'IPOæ”¯æ´', 'IPOæº–å‚™', 'ä¸Šå ´æº–å‚™', 'æ ªå¼å…¬é–‹', 'è¨¼åˆ¸ä¼šç¤¾å¯¾å¿œ',
  
  // M&Aé–¢é€£  
  'M&A', 'M&Aã‚¢ãƒ‰ãƒã‚¤ã‚¶ãƒªãƒ¼', 'ä¼æ¥­è²·å', 'ä¼æ¥­å£²å´', 'PMI', 'DDï¼ˆãƒ‡ãƒ¥ãƒ¼ãƒ‡ãƒªã‚¸ã‚§ãƒ³ã‚¹ï¼‰',
  
  // è³‡é‡‘èª¿é”
  'è³‡é‡‘èª¿é”', 'VCå¯¾å¿œ', 'éŠ€è¡ŒæŠ˜è¡', 'å‚µå‹™èª¿æ•´', 'è³‡æœ¬æ”¿ç­–', 'ã‚¨ã‚¯ã‚¤ãƒ†ã‚£ãƒ•ã‚¡ã‚¤ãƒŠãƒ³ã‚¹',
  
  // è²¡å‹™æˆ¦ç•¥
  'è²¡å‹™æˆ¦ç•¥', 'äºˆç®—ç®¡ç†', 'ä¸­æœŸè¨ˆç”»', 'äº‹æ¥­è¨ˆç”»', 'æŠ•è³‡è¨ˆç”»', 'ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼ç®¡ç†',
  
  // çµŒç†ãƒ»ä¼šè¨ˆ
  'è²¡å‹™ä¼šè¨ˆ', 'ç®¡ç†ä¼šè¨ˆ', 'ç¨å‹™', 'é€£çµæ±ºç®—', 'æœˆæ¬¡æ±ºç®—', 'åŸä¾¡è¨ˆç®—', 'äºˆå®Ÿç®¡ç†',
  
  // å†…éƒ¨çµ±åˆ¶ãƒ»ã‚¬ãƒãƒŠãƒ³ã‚¹
  'å†…éƒ¨çµ±åˆ¶', 'SOXæ³•å¯¾å¿œ', 'ã‚¬ãƒãƒŠãƒ³ã‚¹', 'ãƒªã‚¹ã‚¯ç®¡ç†', 'ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹', 'ç›£æŸ»å¯¾å¿œ',
  
  // IRãƒ»é–‹ç¤º
  'IR', 'æ±ºç®—èª¬æ˜ä¼š', 'æœ‰ä¾¡è¨¼åˆ¸å ±å‘Šæ›¸', 'é–‹ç¤ºæ¥­å‹™', 'æ ªä¸»å¯¾å¿œ',
  
  // ã‚·ã‚¹ãƒ†ãƒ ãƒ»DX
  'çµŒç†ã‚·ã‚¹ãƒ†ãƒ ', 'ERPå°å…¥', 'DXæ¨é€²', 'BIãƒ„ãƒ¼ãƒ«', 'ã‚·ã‚¹ãƒ†ãƒ å°å…¥',
  
  // æ¥­ç•Œå°‚é–€
  'SaaS', 'IT', 'è£½é€ æ¥­', 'å°å£²', 'ä¸å‹•ç”£', 'ãƒ˜ãƒ«ã‚¹ã‚±ã‚¢', 'é‡‘è',
  
  // æµ·å¤–ãƒ»å›½éš›
  'æµ·å¤–å±•é–‹', 'å›½éš›ç¨å‹™', 'IFRS', 'æµ·å¤–å­ä¼šç¤¾ç®¡ç†', 'ã‚¯ãƒ­ã‚¹ãƒœãƒ¼ãƒ€ãƒ¼M&A'
];

const BUSINESS_ISSUES = [
  // è³‡é‡‘ãƒ»è³‡æœ¬é–¢é€£
  'IPOæº–å‚™', 'è³‡é‡‘èª¿é”', 'è³‡æœ¬æ”¿ç­–', 'VCå¯¾å¿œ', 'éŠ€è¡Œã¨ã®é–¢ä¿‚æ”¹å–„',
  
  // è²¡å‹™ä½“åˆ¶
  'è²¡å‹™ä½“åˆ¶å¼·åŒ–', 'ç®¡ç†ä¼šè¨ˆå°å…¥', 'äºˆç®—ç®¡ç†', 'çµŒç†æ¥­å‹™åŠ¹ç‡åŒ–', 'æœˆæ¬¡æ±ºç®—æ—©æœŸåŒ–',
  
  // æˆé•·ãƒ»äº‹æ¥­æ‹¡å¤§  
  'äº‹æ¥­æ‹¡å¤§', 'æ–°è¦äº‹æ¥­', 'æµ·å¤–å±•é–‹', 'M&Aæ¤œè¨', 'æŠ•è³‡åˆ¤æ–­',
  
  // ã‚³ã‚¹ãƒˆãƒ»åç›Šæ€§
  'ã‚³ã‚¹ãƒˆå‰Šæ¸›', 'ã‚³ã‚¹ãƒˆæœ€é©åŒ–', 'åç›Šæ€§æ”¹å–„', 'åŸä¾¡ç®¡ç†', 'æç›Šç®¡ç†',
  
  // ä½“åˆ¶ãƒ»ã‚¬ãƒãƒŠãƒ³ã‚¹
  'å†…éƒ¨çµ±åˆ¶', 'ã‚¬ãƒãƒŠãƒ³ã‚¹å¼·åŒ–', 'ãƒªã‚¹ã‚¯ç®¡ç†', 'ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹',
  
  // ã‚·ã‚¹ãƒ†ãƒ ãƒ»DX
  'çµŒç†ã‚·ã‚¹ãƒ†ãƒ å°å…¥', 'DXæ¨é€²', 'ERPã‚·ã‚¹ãƒ†ãƒ ', 'ãƒšãƒ¼ãƒ‘ãƒ¼ãƒ¬ã‚¹åŒ–',
  
  // äººæãƒ»çµ„ç¹”
  'çµŒç†äººæä¸è¶³', 'CFOäººæç¢ºä¿', 'è²¡å‹™ãƒãƒ¼ãƒ å¼·åŒ–', 'çµŒç†æ•™è‚²'
];

export async function GET(request: NextRequest) {
  try {
    console.log('ğŸ¯ ã‚¹ã‚­ãƒ«ãƒã‚¹ã‚¿ãƒ¼API - æ–°ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ç‰ˆ')

    const { searchParams } = new URL(request.url)
    const category = searchParams.get('category')

    let skills: string[] = []
    let categoryName = ''

    // ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«ã‚¹ã‚­ãƒ«ã‚’æä¾›
    switch (category) {
      case 'finance':
      case 'cfo':
        skills = FINANCE_SKILLS
        categoryName = 'CFOã‚¹ã‚­ãƒ«'
        break
      case 'business':
      case 'issues':
        skills = BUSINESS_ISSUES  
        categoryName = 'ä¼æ¥­èª²é¡Œ'
        break
      default:
        // å…¨ã¦ã®ã‚¹ã‚­ãƒ«ã‚’æä¾›
        skills = [...FINANCE_SKILLS, ...BUSINESS_ISSUES]
        categoryName = 'å…¨ã‚¹ã‚­ãƒ«'
    }

    // API ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã«å¤‰æ›
    const skillsData = skills.map((skill, index) => ({
      id: index + 1,
      name: skill,
      description: `${skill}ã«é–¢ã™ã‚‹å°‚é–€çŸ¥è­˜ãƒ»çµŒé¨“`,
      category: categoryName,
      isActive: true,
      displayOrder: index + 1
    }))

    const response = {
      success: true,
      data: {
        skills: skillsData,
        grouped: {
          [categoryName]: skillsData
        },
        categories: [categoryName],
        meta: {
          architecture: 'new',
          source: 'hardcoded',
          total: skills.length,
          category: category || 'all'
        }
      }
    }

    console.log(`âœ… ã‚¹ã‚­ãƒ«ä¸€è¦§æä¾›: ${skills.length}ä»¶ (${categoryName})`)

    return NextResponse.json(response)

  } catch (error) {
    console.error('ğŸš¨ ã‚¹ã‚­ãƒ«ãƒã‚¹ã‚¿ãƒ¼API ã‚¨ãƒ©ãƒ¼:', error)
    return NextResponse.json(
      { 
        success: false, 
        error: 'ã‚¹ã‚­ãƒ«ä¸€è¦§ã®å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
        meta: { architecture: 'new', source: 'hardcoded' }
      },
      { status: 500 }
    )
  }
}

// POST: æ–°ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã¯ä¸è¦ï¼ˆå›ºå®šãƒªã‚¹ãƒˆã®ãŸã‚ï¼‰
export async function POST(request: NextRequest) {
  return NextResponse.json(
    { 
      success: false, 
      error: 'æ–°ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã¯ã‚¹ã‚­ãƒ«ã®å‹•çš„è¿½åŠ ã¯ä¸è¦ã§ã™ã€‚å›ºå®šãƒªã‚¹ãƒˆã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚',
      meta: { architecture: 'new', feature: 'disabled' }
    },
    { status: 501 }
  )
}